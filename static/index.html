<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JobHunt ‚Äî Indeed Scraper</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:ital,wght@0,400;0,500;1,400&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg: #0a0a0f;
            --surface: #12121a;
            --surface2: #1a1a26;
            --border: #2a2a3d;
            --accent: #6ee7b7;
            --accent2: #818cf8;
            --accent3: #f472b6;
            --text: #e2e8f0;
            --muted: #64748b;
            --danger: #f87171;
            --warn: #fbbf24;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Syne', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated background grid */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image:
                linear-gradient(rgba(110, 231, 183, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(110, 231, 183, 0.03) 1px, transparent 1px);
            background-size: 48px 48px;
            pointer-events: none;
            z-index: 0;
        }

        /* Glow orbs */
        .orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.15;
            pointer-events: none;
            z-index: 0;
            animation: drift 12s ease-in-out infinite;
        }

        .orb-1 {
            width: 400px;
            height: 400px;
            background: var(--accent2);
            top: -100px;
            right: -100px;
        }

        .orb-2 {
            width: 300px;
            height: 300px;
            background: var(--accent);
            bottom: 100px;
            left: -80px;
            animation-delay: -6s;
        }

        @keyframes drift {

            0%,
            100% {
                transform: translate(0, 0);
            }

            50% {
                transform: translate(30px, 20px);
            }
        }

        /* Layout */
        .wrapper {
            position: relative;
            z-index: 1;
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 24px 80px;
        }

        /* Header */
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 28px 0 48px;
            border-bottom: 1px solid var(--border);
            margin-bottom: 56px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent), var(--accent2));
            border-radius: 10px;
            display: grid;
            place-items: center;
            font-size: 20px;
        }

        .logo-text {
            font-size: 22px;
            font-weight: 800;
            letter-spacing: -0.5px;
        }

        .logo-text span {
            color: var(--accent);
        }

        .header-badge {
            font-family: 'DM Mono', monospace;
            font-size: 11px;
            color: var(--accent);
            border: 1px solid rgba(110, 231, 183, 0.3);
            background: rgba(110, 231, 183, 0.05);
            padding: 6px 14px;
            border-radius: 100px;
            letter-spacing: 1px;
        }

        /* Hero */
        .hero {
            margin-bottom: 52px;
        }

        .hero h1 {
            font-size: clamp(36px, 6vw, 64px);
            font-weight: 800;
            line-height: 1.05;
            letter-spacing: -2px;
            margin-bottom: 16px;
        }

        .hero h1 .line2 {
            color: var(--accent);
        }

        .hero p {
            font-size: 16px;
            color: var(--muted);
            font-family: 'DM Mono', monospace;
            max-width: 480px;
            line-height: 1.7;
        }

        /* Search Panel */
        .panel {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 36px;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
        }

        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent), var(--accent2), var(--accent3));
        }

        .panel-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--muted);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 28px;
            font-family: 'DM Mono', monospace;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 640px) {
            .form-grid {
                grid-template-columns: 1fr;
            }

            header {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }
        }

        .field {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .field.full {
            grid-column: 1 / -1;
        }

        label {
            font-size: 12px;
            font-weight: 600;
            color: var(--muted);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-family: 'DM Mono', monospace;
        }

        input,
        select,
        textarea {
            background: var(--surface2);
            border: 1px solid var(--border);
            color: var(--text);
            font-family: 'DM Mono', monospace;
            font-size: 14px;
            padding: 13px 16px;
            border-radius: 10px;
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
            width: 100%;
        }

        input:focus,
        select:focus,
        textarea:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(110, 231, 183, 0.1);
        }

        input::placeholder,
        textarea::placeholder {
            color: var(--muted);
            opacity: 0.6;
        }

        select option {
            background: var(--surface2);
        }

        /* Tag input */
        .tag-input-wrapper {
            background: var(--surface2);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 10px 12px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
            cursor: text;
            transition: border-color 0.2s, box-shadow 0.2s;
            min-height: 50px;
        }

        .tag-input-wrapper:focus-within {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(110, 231, 183, 0.1);
        }

        .tag {
            background: rgba(110, 231, 183, 0.12);
            color: var(--accent);
            border: 1px solid rgba(110, 231, 183, 0.25);
            border-radius: 6px;
            padding: 4px 10px;
            font-family: 'DM Mono', monospace;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }

        .tag-remove {
            cursor: pointer;
            opacity: 0.6;
            font-size: 14px;
            line-height: 1;
            padding: 0 2px;
            transition: opacity 0.15s;
        }

        .tag-remove:hover {
            opacity: 1;
        }

        .tag-input {
            background: none;
            border: none;
            outline: none;
            color: var(--text);
            font-family: 'DM Mono', monospace;
            font-size: 13px;
            flex: 1;
            min-width: 80px;
            padding: 2px 4px;
        }

        /* Toggles */
        .toggle-row {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 8px;
        }

        .toggle-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 18px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: var(--surface2);
            color: var(--muted);
            font-family: 'DM Mono', monospace;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }

        .toggle-btn.active {
            border-color: rgba(110, 231, 183, 0.4);
            background: rgba(110, 231, 183, 0.08);
            color: var(--accent);
        }

        .toggle-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--border);
            transition: background 0.2s;
        }

        .toggle-btn.active .toggle-dot {
            background: var(--accent);
        }

        /* Submit button */
        .btn-run {
            width: 100%;
            margin-top: 28px;
            padding: 16px;
            background: linear-gradient(135deg, var(--accent), #34d399);
            color: #0a0a0f;
            font-family: 'Syne', sans-serif;
            font-size: 16px;
            font-weight: 700;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            letter-spacing: 0.5px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-run:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(110, 231, 183, 0.25);
        }

        .btn-run:active {
            transform: translateY(0);
        }

        .btn-run:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Status / Loading */
        .status-bar {
            display: none;
            align-items: center;
            gap: 16px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 20px 24px;
            margin-bottom: 32px;
        }

        .status-bar.visible {
            display: flex;
        }

        .spinner {
            width: 24px;
            height: 24px;
            border: 2px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 0.7s linear infinite;
            flex-shrink: 0;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .status-text {
            font-family: 'DM Mono', monospace;
            font-size: 13px;
            color: var(--muted);
        }

        .status-text strong {
            color: var(--text);
        }

        /* Results */
        .results-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .results-count {
            font-size: 13px;
            font-family: 'DM Mono', monospace;
            color: var(--muted);
        }

        .results-count strong {
            color: var(--accent);
            font-size: 20px;
        }

        .btn-export {
            padding: 10px 20px;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--muted);
            font-family: 'DM Mono', monospace;
            font-size: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-export:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        /* Filters row */
        .filters-row {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-chip {
            padding: 8px 16px;
            border-radius: 100px;
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--muted);
            font-family: 'DM Mono', monospace;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.15s;
            letter-spacing: 0.5px;
        }

        .filter-chip.active {
            background: rgba(110, 231, 183, 0.1);
            border-color: rgba(110, 231, 183, 0.4);
            color: var(--accent);
        }

        /* Search in results */
        .results-search {
            margin-bottom: 20px;
            position: relative;
        }

        .results-search input {
            padding-left: 42px;
        }

        .search-icon {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--muted);
            font-size: 16px;
            pointer-events: none;
        }

        /* Job cards */
        .jobs-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .job-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 24px;
            transition: all 0.2s;
            animation: fadeUp 0.3s ease both;
            cursor: pointer;
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 12px;
            align-items: start;
            text-decoration: none;
            color: inherit;
        }

        .job-card:hover {
            border-color: rgba(110, 231, 183, 0.3);
            background: var(--surface2);
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(16px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .job-card:nth-child(1) {
            animation-delay: 0.05s;
        }

        .job-card:nth-child(2) {
            animation-delay: 0.1s;
        }

        .job-card:nth-child(3) {
            animation-delay: 0.15s;
        }

        .job-card:nth-child(4) {
            animation-delay: 0.2s;
        }

        .job-card:nth-child(5) {
            animation-delay: 0.25s;
        }

        .job-main {}

        .job-title {
            font-size: 17px;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 6px;
            line-height: 1.3;
        }

        .job-company {
            font-family: 'DM Mono', monospace;
            font-size: 13px;
            color: var(--accent2);
            margin-bottom: 10px;
        }

        .job-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }

        .meta-pill {
            font-family: 'DM Mono', monospace;
            font-size: 11px;
            padding: 4px 10px;
            border-radius: 6px;
            border: 1px solid var(--border);
            color: var(--muted);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .category-pill {
            font-family: 'DM Mono', monospace;
            font-size: 11px;
            padding: 4px 10px;
            border-radius: 6px;
            font-weight: 600;
        }

        .cat-amazon {
            background: rgba(251, 191, 36, 0.1);
            color: var(--warn);
            border: 1px solid rgba(251, 191, 36, 0.2);
        }

        .cat-marketplace {
            background: rgba(129, 140, 248, 0.1);
            color: var(--accent2);
            border: 1px solid rgba(129, 140, 248, 0.2);
        }

        .cat-leadership {
            background: rgba(244, 114, 182, 0.1);
            color: var(--accent3);
            border: 1px solid rgba(244, 114, 182, 0.2);
        }

        .cat-general {
            background: rgba(110, 231, 183, 0.1);
            color: var(--accent);
            border: 1px solid rgba(110, 231, 183, 0.2);
        }

        .job-actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: flex-end;
        }

        .salary-tag {
            font-family: 'DM Mono', monospace;
            font-size: 13px;
            color: var(--accent);
            font-weight: 500;
            white-space: nowrap;
        }

        .btn-view {
            padding: 8px 18px;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--muted);
            font-family: 'DM Mono', monospace;
            font-size: 11px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.15s;
            text-decoration: none;
            white-space: nowrap;
        }

        .btn-view:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        /* Stats row */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        @media (max-width: 768px) {
            .stats-row {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .stat-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 20px;
            animation: fadeUp 0.4s ease both;
        }

        .stat-card:nth-child(1) {
            animation-delay: 0.05s;
        }

        .stat-card:nth-child(2) {
            animation-delay: 0.1s;
        }

        .stat-card:nth-child(3) {
            animation-delay: 0.15s;
        }

        .stat-card:nth-child(4) {
            animation-delay: 0.2s;
        }

        .stat-label {
            font-family: 'DM Mono', monospace;
            font-size: 11px;
            color: var(--muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 800;
            letter-spacing: -1px;
        }

        .stat-value.green {
            color: var(--accent);
        }

        .stat-value.purple {
            color: var(--accent2);
        }

        .stat-value.pink {
            color: var(--accent3);
        }

        .stat-value.yellow {
            color: var(--warn);
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 80px 24px;
            color: var(--muted);
        }

        .empty-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 20px;
            margin-bottom: 8px;
            color: var(--text);
        }

        .empty-state p {
            font-family: 'DM Mono', monospace;
            font-size: 13px;
            line-height: 1.7;
        }

        /* Error */
        .error-bar {
            display: none;
            background: rgba(248, 113, 113, 0.08);
            border: 1px solid rgba(248, 113, 113, 0.25);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 24px;
            font-family: 'DM Mono', monospace;
            font-size: 13px;
            color: var(--danger);
        }

        .error-bar.visible {
            display: block;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }
    </style>
</head>

<body>

    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>

    <div class="wrapper">

        <!-- Header -->
        <header>
            <div class="logo">
                <div class="logo-icon">üéØ</div>
                <div class="logo-text">Job<span>Hunt</span></div>
            </div>
            <div class="header-badge">INDEED SCRAPER v1.0</div>
        </header>

        <!-- Hero -->
        <div class="hero">
            <h1>Find the jobs<br><span class="line2">others miss.</span></h1>
            <p>Intelligent scraping for e-commerce & marketplace roles. Drop your keywords, pick your filters, get
                results.</p>
        </div>

        <!-- Search Panel -->
        <div class="panel">
            <div class="panel-title">‚ö° Configure Your Search</div>

            <div class="form-grid">
                <!-- Keywords -->
                <div class="field full">
                    <label>Keywords / Job Titles</label>
                    <div class="tag-input-wrapper" id="tagWrapper"
                        onclick="document.getElementById('tagInput').focus()">
                        <input type="text" id="tagInput" class="tag-input"
                            placeholder="Type keyword and press Enter...">
                    </div>
                    <div style="font-family:'DM Mono',monospace;font-size:11px;color:var(--muted);margin-top:6px;">
                        e.g. "Amazon marketplace", "Ecommerce manager", "Shopify growth" ‚Äî press Enter after each
                    </div>
                </div>

                <!-- Location -->
                <div class="field">
                    <label>Location</label>
                    <input type="text" id="location" placeholder="e.g. London, UK or Remote" value="Remote">
                </div>

                <!-- Results per keyword -->
                <div class="field">
                    <label>Results per Keyword</label>
                    <select id="resultsCount">
                        <option value="10">10 results</option>
                        <option value="25" selected>25 results</option>
                        <option value="50">50 results</option>
                        <option value="100">100 results</option>
                    </select>
                </div>
            </div>

            <!-- Marketplace filters -->
            <div class="field" style="margin-bottom:20px;">
                <label>Marketplace Filters (must include in results)</label>
                <div class="toggle-row" id="marketplaceToggles">
                    <div class="toggle-btn active" data-val="amazon" onclick="toggleFilter(this)">
                        <div class="toggle-dot"></div> Amazon
                    </div>
                    <div class="toggle-btn" data-val="shopify" onclick="toggleFilter(this)">
                        <div class="toggle-dot"></div> Shopify
                    </div>
                    <div class="toggle-btn" data-val="ebay" onclick="toggleFilter(this)">
                        <div class="toggle-dot"></div> eBay
                    </div>
                    <div class="toggle-btn" data-val="marketplace" onclick="toggleFilter(this)">
                        <div class="toggle-dot"></div> Marketplace
                    </div>
                    <div class="toggle-btn" data-val="dtc" onclick="toggleFilter(this)">
                        <div class="toggle-dot"></div> DTC / D2C
                    </div>
                    <div class="toggle-btn" data-val="ecommerce" onclick="toggleFilter(this)">
                        <div class="toggle-dot"></div> Ecommerce
                    </div>
                </div>
            </div>

            <!-- Options -->
            <div class="form-grid">
                <div class="field">
                    <label>Strict Filtering</label>
                    <select id="strictFilter">
                        <option value="true" selected>ON ‚Äî Only show relevant jobs</option>
                        <option value="false">OFF ‚Äî Show all found jobs</option>
                    </select>
                </div>
                <div class="field">
                    <label>Date Posted</label>
                    <select id="datePosted">
                        <option value="">Any time</option>
                        <option value="1">Last 24 hours</option>
                        <option value="3" selected>Last 3 days</option>
                        <option value="7">Last 7 days</option>
                        <option value="14">Last 2 weeks</option>
                    </select>
                </div>
            </div>

            <button class="btn-run" id="runBtn" onclick="runScrape()">
                <span id="btnIcon">üöÄ</span>
                <span id="btnText">Launch Scraper</span>
            </button>
        </div>

        <!-- Error -->
        <div class="error-bar" id="errorBar"></div>

        <!-- Loading Status -->
        <div class="status-bar" id="statusBar">
            <div class="spinner"></div>
            <div>
                <div class="status-text"><strong id="statusTitle">Scraping Indeed...</strong></div>
                <div class="status-text" id="statusSub">This may take 2‚Äì5 minutes depending on results count</div>
            </div>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" style="display:none;">

            <!-- Stats -->
            <div class="stats-row" id="statsRow"></div>

            <!-- Results Header -->
            <div class="results-header">
                <div class="results-count">
                    <strong id="resultNum">0</strong> jobs found
                </div>
                <button class="btn-export" onclick="exportCSV()">
                    ‚¨á Export CSV
                </button>
            </div>

            <!-- Category Filters -->
            <div class="filters-row" id="filterChips"></div>

            <!-- Search in results -->
            <div class="results-search">
                <span class="search-icon">üîç</span>
                <input type="text" id="resultSearch" placeholder="Search within results..." oninput="filterResults()">
            </div>

            <!-- Jobs list -->
            <div class="jobs-grid" id="jobsGrid"></div>
        </div>

        <!-- Empty state (initial) -->
        <div class="empty-state" id="emptyState">
            <div class="empty-icon">üîé</div>
            <h3>Ready to hunt</h3>
            <p>Add your keywords above, configure<br>your filters, and hit Launch Scraper.</p>
        </div>

    </div>

    <script>
        // ‚îÄ‚îÄ‚îÄ State ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        let tags = ['Amazon marketplace', 'Ecommerce manager'];
        let allJobs = [];
        let activeCategory = 'All';

        // ‚îÄ‚îÄ‚îÄ API Config ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // CHANGE THIS to your backend URL when deployed
        const API_BASE = 'http://localhost:8000';

        // ‚îÄ‚îÄ‚îÄ Tag Input ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function renderTags() {
            const wrapper = document.getElementById('tagWrapper');
            const input = document.getElementById('tagInput');
            // Remove old tags
            wrapper.querySelectorAll('.tag').forEach(t => t.remove());
            tags.forEach((tag, i) => {
                const el = document.createElement('div');
                el.className = 'tag';
                el.innerHTML = `${tag}<span class="tag-remove" onclick="removeTag(${i})">√ó</span>`;
                wrapper.insertBefore(el, input);
            });
        }

        function removeTag(i) {
            tags.splice(i, 1);
            renderTags();
        }

        document.getElementById('tagInput').addEventListener('keydown', function (e) {
            if ((e.key === 'Enter' || e.key === ',') && this.value.trim()) {
                e.preventDefault();
                tags.push(this.value.trim());
                this.value = '';
                renderTags();
            }
            if (e.key === 'Backspace' && !this.value && tags.length) {
                tags.pop();
                renderTags();
            }
        });

        renderTags();

        // ‚îÄ‚îÄ‚îÄ Marketplace Toggles ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function toggleFilter(el) {
            el.classList.toggle('active');
        }

        function getActiveMarketplaces() {
            return Array.from(document.querySelectorAll('#marketplaceToggles .toggle-btn.active'))
                .map(el => el.dataset.val);
        }

        // ‚îÄ‚îÄ‚îÄ Main Scrape ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        async function runScrape() {
            if (tags.length === 0) {
                showError('Please add at least one keyword before running the scraper.');
                return;
            }

            const btn = document.getElementById('runBtn');
            btn.disabled = true;
            document.getElementById('btnText').textContent = 'Scraping...';
            document.getElementById('btnIcon').textContent = '‚è≥';
            document.getElementById('statusBar').classList.add('visible');
            document.getElementById('resultsSection').style.display = 'none';
            document.getElementById('emptyState').style.display = 'none';
            document.getElementById('errorBar').classList.remove('visible');

            // Cycle status messages
            const msgs = [
                ['Launching Chrome...', 'Setting up headless browser'],
                ['Connecting to Indeed...', 'Bypassing bot detection'],
                ['Running searches...', `Querying: ${tags.slice(0, 2).join(', ')}...`],
                ['Fetching job descriptions...', 'Opening each job page for full details'],
                ['Filtering results...', 'Applying your marketplace filters'],
                ['Categorising jobs...', 'Assigning categories based on keywords'],
            ];
            let msgIdx = 0;
            const interval = setInterval(() => {
                if (msgIdx < msgs.length) {
                    document.getElementById('statusTitle').textContent = msgs[msgIdx][0];
                    document.getElementById('statusSub').textContent = msgs[msgIdx][1];
                    msgIdx++;
                }
            }, 15000);

            try {
                const payload = {
                    keywords: tags,
                    location: document.getElementById('location').value || 'Remote',
                    results_per_keyword: parseInt(document.getElementById('resultsCount').value),
                    marketplaces: getActiveMarketplaces(),
                    strict_filter: document.getElementById('strictFilter').value === 'true',
                    date_posted: document.getElementById('datePosted').value || null,
                };

                const response = await fetch(`${API_BASE}/scrape`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const err = await response.json().catch(() => ({}));
                    throw new Error(err.detail || `Server error: ${response.status}`);
                }

                const data = await response.json();
                allJobs = data.jobs || [];
                displayResults(allJobs);

            } catch (err) {
                // ‚îÄ‚îÄ DEMO MODE when backend not connected ‚îÄ‚îÄ
                if (err.message.includes('fetch') || err.message.includes('Failed') || err.message.includes('NetworkError') || err.message.includes('connect')) {
                    allJobs = generateDemoJobs(tags, document.getElementById('location').value);
                    displayResults(allJobs);
                    showInfo('‚ö†Ô∏è Backend not connected ‚Äî showing demo data. Connect your api.py server at ' + API_BASE);
                } else {
                    showError('Error: ' + err.message);
                    document.getElementById('emptyState').style.display = 'block';
                    document.getElementById('emptyState').querySelector('h3').textContent = 'Scrape failed';
                    document.getElementById('emptyState').querySelector('p').textContent = err.message;
                }
            } finally {
                clearInterval(interval);
                btn.disabled = false;
                document.getElementById('btnText').textContent = 'Launch Scraper';
                document.getElementById('btnIcon').textContent = 'üöÄ';
                document.getElementById('statusBar').classList.remove('visible');
            }
        }

        // ‚îÄ‚îÄ‚îÄ Display Results ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function displayResults(jobs) {
            document.getElementById('resultsSection').style.display = 'block';
            document.getElementById('emptyState').style.display = 'none';
            document.getElementById('resultNum').textContent = jobs.length;

            renderStats(jobs);
            renderCategoryChips(jobs);
            renderJobs(jobs);
        }

        function renderStats(jobs) {
            const cats = {};
            jobs.forEach(j => cats[j.category] = (cats[j.category] || 0) + 1);
            const withSalary = jobs.filter(j => j.salary && j.salary !== 'N/A').length;

            const topCat = Object.entries(cats).sort((a, b) => b[1] - a[1])[0];

            document.getElementById('statsRow').innerHTML = `
      <div class="stat-card">
        <div class="stat-label">Total Jobs</div>
        <div class="stat-value green">${jobs.length}</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Categories</div>
        <div class="stat-value purple">${Object.keys(cats).length}</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">With Salary</div>
        <div class="stat-value yellow">${withSalary}</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Top Category</div>
        <div class="stat-value pink" style="font-size:18px;letter-spacing:-0.5px;">${topCat ? topCat[0] : '‚Äî'}</div>
      </div>
    `;
        }

        function renderCategoryChips(jobs) {
            const cats = ['All', ...new Set(jobs.map(j => j.category).filter(Boolean))];
            document.getElementById('filterChips').innerHTML = cats.map(c => `
      <div class="filter-chip ${c === activeCategory ? 'active' : ''}" onclick="setCategoryFilter('${c}')">${c}</div>
    `).join('');
        }

        function setCategoryFilter(cat) {
            activeCategory = cat;
            renderCategoryChips(allJobs);
            filterResults();
        }

        function filterResults() {
            const q = document.getElementById('resultSearch').value.toLowerCase();
            const filtered = allJobs.filter(j => {
                const matchCat = activeCategory === 'All' || j.category === activeCategory;
                const matchQ = !q || j.title?.toLowerCase().includes(q) || j.company?.toLowerCase().includes(q) || j.location?.toLowerCase().includes(q);
                return matchCat && matchQ;
            });
            renderJobs(filtered);
            document.getElementById('resultNum').textContent = filtered.length;
        }

        function renderJobs(jobs) {
            const grid = document.getElementById('jobsGrid');
            if (!jobs.length) {
                grid.innerHTML = `<div style="text-align:center;padding:60px;color:var(--muted);font-family:'DM Mono',monospace;">No jobs match your current filters.</div>`;
                return;
            }

            grid.innerHTML = jobs.map(j => {
                const catClass = getCatClass(j.category);
                return `
        <a class="job-card" href="${j.url || '#'}" target="_blank" rel="noopener">
          <div class="job-main">
            <div class="job-title">${j.title || 'Untitled Role'}</div>
            <div class="job-company">üè¢ ${j.company || 'Unknown Company'}</div>
            <div class="job-meta">
              ${j.location ? `<div class="meta-pill">üìç ${j.location}</div>` : ''}
              ${j.date_posted ? `<div class="meta-pill">üìÖ ${j.date_posted}</div>` : ''}
              ${j.category ? `<div class="category-pill ${catClass}">${j.category}</div>` : ''}
            </div>
          </div>
          <div class="job-actions">
            ${j.salary && j.salary !== 'N/A' ? `<div class="salary-tag">${j.salary}</div>` : ''}
            <span class="btn-view">View ‚Üí</span>
          </div>
        </a>
      `;
            }).join('');
        }

        function getCatClass(cat) {
            if (!cat) return 'cat-general';
            const c = cat.toLowerCase();
            if (c.includes('amazon')) return 'cat-amazon';
            if (c.includes('marketplace') || c.includes('general')) return 'cat-marketplace';
            if (c.includes('leader') || c.includes('senior') || c.includes('director')) return 'cat-leadership';
            return 'cat-general';
        }

        // ‚îÄ‚îÄ‚îÄ Export CSV ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function exportCSV() {
            if (!allJobs.length) return;
            const cols = ['title', 'company', 'location', 'salary', 'category', 'date_posted', 'url'];
            const rows = [cols.join(','), ...allJobs.map(j =>
                cols.map(c => `"${(j[c] || '').toString().replace(/"/g, '""')}"`).join(',')
            )];
            const blob = new Blob([rows.join('\n')], { type: 'text/csv' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `jobhunt_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
        }

        // ‚îÄ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function showError(msg) {
            const bar = document.getElementById('errorBar');
            bar.textContent = msg;
            bar.classList.add('visible');
        }

        function showInfo(msg) {
            const bar = document.getElementById('errorBar');
            bar.style.background = 'rgba(251,191,36,0.08)';
            bar.style.borderColor = 'rgba(251,191,36,0.25)';
            bar.style.color = 'var(--warn)';
            bar.textContent = msg;
            bar.classList.add('visible');
        }

        // ‚îÄ‚îÄ‚îÄ Demo Data Generator ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function generateDemoJobs(keywords, location) {
            const companies = ['Jungle Scout', 'Helium 10', 'Perpetua', 'Teikametrics', 'pattern', 'Accel Club', 'Branded', 'Elevate Brands', 'Forum Brands', 'Heroes', 'Moonshot Brands', 'Thrasio'];
            const categories = ['Amazon-Specific', 'Marketplace General', 'Leadership Roles', 'Ecommerce General'];
            const salaries = ['¬£35,000‚Äì¬£45,000', '¬£45,000‚Äì¬£60,000', '¬£60,000‚Äì¬£80,000', '$70K‚Äì$90K', '$90K‚Äì$120K', 'N/A', 'Competitive', '¬£50,000+'];
            const days = ['1 day ago', '2 days ago', '3 days ago', 'today', 'just posted', '5 days ago'];
            const locs = [location || 'Remote', 'London, UK', 'Remote', 'New York, NY', 'Austin, TX', 'Manchester, UK'];

            return Array.from({ length: 18 }, (_, i) => ({
                title: `${keywords[i % keywords.length] || 'Amazon'} ${['Manager', 'Specialist', 'Lead', 'Director', 'Analyst', 'Coordinator'][i % 6]}`,
                company: companies[i % companies.length],
                location: locs[i % locs.length],
                salary: salaries[i % salaries.length],
                category: categories[i % categories.length],
                date_posted: days[i % days.length],
                url: 'https://indeed.com',
            }));
        }
    </script>
</body>

</html>